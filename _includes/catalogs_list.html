{% comment %}
Renders the catalogs from a Jekyll _data CSV/YAML.
Usage:
  {% include catalogs_list.html data_key='catalogs' %}
Looks for site.data[data_key] (defaults to 'catalogs').
CSV header keys expected (case-sensitive):
name, landing_url, doi, license, redshift_survey, redshift_sample, redshift_type,
shape_survey, shape_sample, shape_method, sky_area_deg2, n_clustering, n_shapes, aux, notes
{% endcomment %}

{% assign rows = site.data[include.data_key | default: 'catalogs'] %}

<section class="wrapper style4 container">
  <div class="content">
    <section>
      <header><h3>Catalog list</h3></header>

      <div class="catalog-list">
        {% if rows and rows.size > 0 %}
          {% for c in rows %}
            <details class="catalog-item">
              <summary>
                <strong class="name">{{ c.name }}</strong>
                {% if c.doi %} · <a class="ext" href="https://doi.org/{{ c.doi }}" target="_blank" rel="noopener">DOI</a>{% endif %}
                {% if c.landing_url %} · <a class="ext" href="{{ c.landing_url }}" target="_blank" rel="noopener">Link</a>{% endif %}
                {% if c.license %} · <span class="license">{{ c.license }}</span>{% endif %}
              </summary>

              <div class="catalog-grid">
                <div>
                  <h4>Redshift</h4>
                  <p>
                    {{ c.redshift_survey | default: '—' }}
                    {% if c.redshift_sample %} — {{ c.redshift_sample }}{% endif %}
                    {% if c.redshift_type %} ({{ c.redshift_type }}){% endif %}
                  </p>
                </div>

                <div>
                  <h4>Shapes</h4>
                  <p>
                    {{ c.shape_survey | default: '—' }}
                    {% if c.shape_sample %} — {{ c.shape_sample }}{% endif %}
                    {% if c.shape_method %} ({{ c.shape_method }}){% endif %}
                  </p>
                </div>

                <div>
                  <h4>Footprint</h4>
                  <p>{% if c.sky_area_deg2 %}{{ c.sky_area_deg2 }} deg²{% else %}—{% endif %}</p>
                </div>

                <div>
                  <h4>Counts</h4>
                  <p>
                    clustering: {{ c.n_clustering | default: '—' }}<br />
                    shapes: {{ c.n_shapes | default: '—' }}
                  </p>
                </div>

                <div>
                  <h4>Aux</h4>
                  <p>{{ c.aux | default: '—' }}</p>
                </div>

                <div>
                  <h4>Notes</h4>
                  <p>{{ c.notes | default: '—' }}</p>
                </div>
              </div>
            </details>
          {% endfor %}
        {% else %}
          <p><em>No catalogs yet. Be the first to <a href="{{ '/submit/' | relative_url }}">submit one</a>!</em></p>
        {% endif %}
      </div>
    </section>
  </div>
</section>
